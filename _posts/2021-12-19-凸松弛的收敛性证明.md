---
layout: post
title: 列车节能运控优化中凸松弛收敛性证明
description: 在前面的文章中，我们简单阐述了在列车运控优化问题中引入凸松弛后能够将可行域转为凸域和速度轨迹带来的形式化表达。在本文中，我们将讨论如何用归谬法来证明凸松弛对原问题的最优解没有影响，换言之，松弛虽然带来了可行域的变化，但是最优解并没有因为可行域的松弛而导致最优解变化，而且可以证明，当取得最优解的时候，松弛后的不等式必须严格取等号。
permalink: /blog/convex_3/
date: 2021-12-19
category: featured
tag:
- academic
- optimal train control
- constraints relaxation
- convex optimization
---

![Quadratic Function](/images/blog/Quadratic-Function.png "Quadratic Function")
# 前言
在前面的[文一](http://lushaofeng.github.io/blog/convex_1)与[文二](http://lushaofeng.github.io/blog/convex_2)中，我们简单阐述了在列车运控优化问题中引入凸松弛后能够将可行域转为凸域和速度轨迹带来的形式化表达。在本文中，我们将讨论如何用归谬法来证明凸松弛对原问题的最优解没有影响，换言之，松弛虽然带来了可行域的变化，但是最优解并没有因为可行域的松弛而导致最优解变化，而且可以证明，当取得最优解的时候，松弛后的不等式必须严格取等号。

# 两组列车最优控制模型
![Optimal Train Control Based on Convexification](/images/blog/convexification.png "Optimal Train Control Based on Convexification")
图中展示了凸优化松弛前后的两组建模方法。松弛后，我们在时间计算和阻力计算中引入了两组凸松弛变量$$\alpha_i$$和$$\beta_i$$。目标函数是最小化所有能耗$$E_i$$的累加,当列车为牵引状态时$$E_i\geq0$$，再生制动时候，$$E_i\leq0$$。可以看出，目标函数的设置，将能量的计算总是逼近于能耗计算不等式的右侧，其实目标函数因此等价于最小化以下函数：
$$\sum_i F_i\Delta d_i=0.5M(v_t^2-v_0^2)+\sum_i f_i\Delta d+Mg\Delta H\\
=B\sum_i v_{ave,i}+ C \sum_i \beta_i+Mg\Delta H+0.5M(v_t^2-v_0^2) +NA$$
注意到后面三项对于始末速度固定的两个站台列车运行而言为常数。

# 凸松弛条件的收敛性证明
下面我们要利用反证法来证明当优化模型取得最优解的时候，该最优解一定只能凸松弛条件取等号的时候。注意，我们证明的前提是在原问题具有可行解这个前提下来进行的。具体的步骤是，假设存在一个最优解在至少某一凸松弛条件下取得，也即不等式在严格不等条件下取得。然后提出，至少存在一组可行解，一定可以取得比原有假设的最优解更优的解，得到一个与原有假设相悖的结论。于是推导出，不存在一组最优解在凸松弛取严格不等式的条件下取得这一结论，进而得到凸松弛约束在最优解一定收敛这一定理。

假设存在一组最优解$$v^*_i, \alpha_i^*, \beta_i^*$$在某一个凸松弛 $$1<v_{ave,i}^*\alpha^*_i$$这一严格不等式的条件下取得。那么一定存在一个足够小的正数 $$\epsilon$$使得不等式 $$1<=(v_{ave,i}^*-\epsilon)\alpha^*_i$$依旧成立，因为该不等式成立的条件是$$0\leq \epsilon\leq v_{ave,i}^*-1/\alpha^*_i $$。

定义$$\tilde{v}_{ave,i}=v_{ave,i}^*-\epsilon$$, 那么存在新的一组包含$$\tilde{v}_{ave,i}$$的一组可行解，该可行解除了在第$$i$$段的变量不同，其他都与原有解的决定变量一致。通过观察前面所描述的目标函数，可以看出由包含$$\tilde{v}_{ave,i}$$的这组可行解直接带来目标函数的降低，关注目标函数中的$$\sum_i v_{ave,i}$$项。

注意到，该假设在我们提出的列车运行模型中并不是特别严谨。因为每改变一个速度点会至少同时影响两个平均速度。在证明的时候，更严谨地表述应假设存在两个相邻的平均速度存在于严格不等式上，然后存在两个足够小的数值获取另外一个可行解且具有更小的目标函数值。问题得证。

用同样的方法，我们可以针对$$\beta_i$$做非常类似的证明。假设存在一个$$\beta_i^*$$存在于严格不等式上，那么我们可以找到一个足够小的数值取得包含$$\tilde{\beta}_i=\beta_i^*-\epsilon$$的一组可行解，并带来更低的目标函数值，参见目标函数的$$\sum_i \beta_i$$项。

# 小结
通过以上的分析，可以证明所提出的凸松弛变量将在最优化过程中被严格收敛到等式上。这点对于列车运行控制优化而言至关重要。如果所取得的最优解在严格不等式上取得，那么所取得的解很可能不满足优化问题的物理性约束，比如计算的时间和速度轨迹并不匹配，这会导致优化的结果并不符合工程实际。当然，该模型还有很多需要提升的地方，其中针对更加非线性的列车电机牵引特性和氢燃料电池列车等新型牵引系统方面，还需要进行更多深入的研究。
